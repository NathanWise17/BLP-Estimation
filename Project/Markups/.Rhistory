mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.01,.01)
plot
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.0025,.0025)
plot2
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.001,.001)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.0005,.0005)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.00075,.00075)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.0001,.0001)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.00075,.00075)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.00001,.00001)
plot3
plot3 <- plot + xlim(-.00005,.00005)
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.00005,.00005)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.00001,.00001)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.0001,.0001)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.0001,.0001)
plot3
#Creates Variables of Interest
data$adjstore <- ifelse(data$store == 98, 1, ifelse(data$store == 100, 2, ifelse(data$store == 101, 3, ifelse(data$store == 102, 4, ifelse(data$store == 103, 5, ifelse(data$store == 105, 6, ifelse(data$store == 122, 7, ifelse(data$store == 128, 8, 9))))))))
data$wp <- data$price * (1-(data$profit/100))
data$mks <- data$move / data$custcoun
data <- data %>%
mutate(market = paste(store,week,sep="_"))
sumshare <- data %>%
group_by(market) %>%
summarise(
summks = sum(mks)
)
data <- data %>%
left_join(sumshare, by = "market")
data$csame <- ifelse(data$Brand == 18200, 1, ifelse(data$Brand == 34100, 6, 1))
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.0005,.0005)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.0005,.0005)
plot3
library(ggplot2)
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project/Markups")
mumulti <- read.csv("mumulti.csv")
musingle <- read.csv("musingle.csv")
mumonop <- read.csv("mumonop.csv")
mufull <- mumulti
mufull$multi <- mumulti$X0
mufull$single <- musingle$X0
mufull$monop <- mumonop$X0
plot <- ggplot() +
geom_density(data = data.frame(x=mufull$multi), aes(x=x),color = "black") +
geom_density(data = data.frame(x = mufull$single), aes(x=x),color = "blue") +
geom_density(data= data.frame(x = mufull$monop), aes(x=x), color = "red") +
labs(title = "Density Plot")
plot <- plot +
xlim(-.005,.005)
plot
plot2 <- plot + xlim(-.002,.002)
plot2
plot3 <- plot + xlim(-.00005,.00005)
plot3
OLSlogit1 <- lm(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
summary(OLSlogit1)
coeftest(OLSlogit1, vcov = vcovHC(OLSlogit1,"HC1"))
test <- lm(y ~ price + factor(upc) + 0, data = data)
summary(test)
OLSlogit1 <- lm(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
summary(OLSlogit1)
#2SLS with wholesale
tsls1 <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tsls1)
tsls2baselogit <- lm(y ~ pricewp.hat + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2baselogit,vcov = vcovHC(tsls2baselogit,type="HC1"))
ivwp1 <- ivreg(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(ivwp1,vcov = vcovHC(ivwp1,type="HC1"))
#2SLS with same counts
tsls1 <- lm(price ~ csame + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricecs.hat <- fitted.values(tsls1)
tsls2cs <- lm(y ~ pricecs.hat + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2cs,vcov = vcovHC(tsls2cs,type="HC1"))
ivcs1 <- ivreg(y ~ price + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | csame + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(ivcs1,vcov = vcovHC(ivcs1,type="HC1"))
#2SLS with other producer counts
tsls1 <- lm(price ~ cdiff + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricecd.hat <- fitted.values(tsls1)
tsls2cd <- lm(y ~ pricecd.hat + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2cd,vcov = (vcovHC(tsls2cd,"HC1")))
#2SLS with wholesale
tslswp <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tsls1)
tsls2baselogit <- lm(y ~ pricewp.hat + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2baselogit,vcov = vcovHC(tsls2baselogit,type="HC1"))
ivwp <- ivreg(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(ivwp1,vcov = vcovHC(ivwp1,type="HC1"))
#2SLS with same counts
tslssc <- lm(price ~ csame + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricecs.hat <- fitted.values(tsls1)
tsls2cs <- lm(y ~ pricecs.hat + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2cs,vcov = vcovHC(tsls2cs,type="HC1"))
ivcssc <- ivreg(y ~ price + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | csame + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(ivcs1,vcov = vcovHC(ivcs1,type="HC1"))
#2SLS with other producer counts
tslspc <- lm(price ~ cdiff + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricecd.hat <- fitted.values(tsls1)
tsls2cd <- lm(y ~ pricecd.hat + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2cd,vcov = (vcovHC(tsls2cd,"HC1")))
stargazer(OLSlogit1,tslswp,tslssc,tslswc)
stargazer(OLSlogit1,tslswp,tslssc,tslspc)
#2SLS with wholesale
tslswp <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tsls1)
tsls2baselogit <- lm(y ~ pricewp.hat + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2baselogit,vcov = vcovHC(tsls2baselogit,type="HC1"))
ivwp <- ivreg(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(ivwp1,vcov = vcovHC(ivwp1,type="HC1"))
#2SLS with wholesale
tslswp <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tsls1)
tsls2baselogit <- lm(y ~ pricewp.hat + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2baselogit,vcov = vcovHC(tsls2baselogit,type="HC1"))
ivwp <- ivreg(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(ivwp,vcov = vcovHC(ivwp,type="HC1"))
#2SLS with wholesale
tslswp <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tsls1)
tsls2baselogit <- lm(y ~ pricewp.hat + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2baselogit,vcov = vcovHC(tsls2baselogit,type="HC1"))
ivwp <- ivreg(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(ivwp,vcov = vcovHC(ivwp,type="HC1"))
rm(list=ls())
setwd("C:/Users/wisen/OneDrive/Desktop/Work Stuff/PHD/Second Year/IO/Project")
didata <- read.csv("estimateddi.csv")
library(haven)
library(dplyr)
library(ivreg)
library(sandwich)
library(lmtest)
library(psych)
library(stargazer)
library(ggplot2)
library(evd)
library(gmm)
#Read in the Data
data <- read_dta("WBER.dta")
#data1 <- read_dta("WBERtest.dta")
#Creates Variables of Interest
data$adjstore <- ifelse(data$store == 98, 1, ifelse(data$store == 100, 2, ifelse(data$store == 101, 3, ifelse(data$store == 102, 4, ifelse(data$store == 103, 5, ifelse(data$store == 105, 6, ifelse(data$store == 122, 7, ifelse(data$store == 128, 8, 9))))))))
data$wp <- data$price * (1-(data$profit/100))
data$mks <- data$move / data$custcoun
data <- data %>%
mutate(market = paste(store,week,sep="_"))
sumshare <- data %>%
group_by(market) %>%
summarise(
summks = sum(mks)
)
data <- data %>%
left_join(sumshare, by = "market")
data$csame <- ifelse(data$Brand == 18200, 1, ifelse(data$Brand == 34100, 6, 1))
data$cdiff <- ifelse(data$Brand == 18200, 9, ifelse(data$Brand == 34100, 4, 9))
data$Prod1 <- as.numeric(data$upc == 1820000016)
data$Prod2 <- as.numeric(as.numeric(data$upc) == 1820011168)
data$Prod3 <- as.numeric(data$upc == 3410000354)
data$Prod4 <- as.numeric(data$upc == 3410000554)
data$Prod5 <- as.numeric(data$upc == 3410017306)
data$Prod6 <- as.numeric(data$upc == 3410017505)
data$Prod7 <- as.numeric(data$upc == 3410057306)
data$Prod8 <- as.numeric(data$upc == 3410057528)
data$Prod9 <- as.numeric(data$upc == 3410057602)
data$Prod10 <- as.numeric(data$upc == 7336011341)
data$Prod11 <- as.numeric(data$upc == 7336011751)
#Shares
total_share = 1
Outside_share = total_share - data$summks
data$os <- Outside_share
data$y <- log(data$mks / data$os)
colnames(data) <- c("store","upc","week","move","price","profit","descrip","custcoun","brand","adjstore","wp","mks","market","summks","csame","cdiff","Prod1","Prod2","Prod3","Prod4","Prod5","Prod6","Prod7","Prod8","Prod9","Prod10","Prod11","os","y")
head(data)
#Calculating Average Prices by product
avgpricebyweek <- data %>%
group_by(upc, week) %>%
summarise(avg_price_product = mean(price,na.rm = TRUE))
data <- data %>%
left_join(avgpricebyweek,by = c("upc","week"))
data$pricediff_product <- data$price - data$avg_price_product
OLSlogit1 <- lm(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
summary(OLSlogit1)
#2SLS with wholesale
tslswp <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tsls1)
#2SLS with wholesale
tslswp <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tslswp)
tsls2baselogit <- lm(y ~ pricewp.hat + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2baselogit,vcov = vcovHC(tsls2baselogit,type="HC1"))
ivwp <- ivreg(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(ivwp,vcov = vcovHC(ivwp,type="HC1"))
stargazer(OLSlogit1,ivwp)
stargazer(OLSlogit1,ivwpr)
#2SLS with wholesale
tslswp <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tslswp)
tsls2baselogit <- lm(y ~ pricewp.hat + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
coeftest(tsls2baselogit,vcov = vcovHC(tsls2baselogit,type="HC1"))
ivwp <- ivreg(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
ivwpr <- coeftest(ivwp,vcov = vcovHC(ivwp,type="HC1"))
stargazer(OLSlogit1,ivwpr)
ivwpr
#2SLS with wholesale
tslswp <- lm(price ~ wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
pricewp.hat <- fitted.values(tslswp)
tsls2baselogit <- lm(y ~ pricewp.hat + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
tslswpr <- coeftest(tsls2baselogit,vcov = vcovHC(tsls2baselogit,type="HC1"))
ivwp <- ivreg(y ~ price + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0 | wp + Prod1 + Prod2 + Prod3 + Prod4 + Prod5 + Prod6 + Prod7 + Prod8 + Prod9 + Prod10 + Prod11 +0, data = data)
ivwpr <- coeftest(ivwp,vcov = vcovHC(ivwp,type="HC1"))
ivwpr
tslswpr
